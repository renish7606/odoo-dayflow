{% extends 'hrms/base.html' %}
{% load static %}

{% block title %}Update Salary - {{ employee.get_full_name }} - Dayflow HRMS{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px;">
    <div class="mb-4">
        <a href="{% url 'admin_salary_management' %}" class="text-primary">&larr; Back to Salary Management</a>
    </div>

    <div class="card animate-fadeIn">
        <div class="card-header">
            <h2 class="card-title">Update Salary Structure</h2>
            <p class="text-gray" style="margin: var(--spacing-sm) 0 0 0;">
                {{ employee.employee_id }} - {{ employee.get_full_name }}
            </p>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}

                <h4 class="mb-3">Basic Salary</h4>
                <div class="form-group">
                    <label for="basic_salary" class="form-label">Basic Salary (₹)</label>
                    <input type="number" step="0.01" name="basic_salary" id="basic_salary"
                        value="{{ latest_payroll.basic_salary|default:'0' }}" class="form-input" required>
                </div>

                <h4 class="mb-3 mt-4">Allowances</h4>
                <div class="grid grid-2" style="gap: var(--spacing-md);">
                    <div class="form-group">
                        <label for="hra" class="form-label">House Rent Allowance (₹)</label>
                        <input type="number" step="0.01" name="hra" id="hra"
                            value="{{ latest_payroll.house_rent_allowance|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="transport" class="form-label">Transport Allowance (₹)</label>
                        <input type="number" step="0.01" name="transport" id="transport"
                            value="{{ latest_payroll.transport_allowance|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="medical" class="form-label">Medical Allowance (₹)</label>
                        <input type="number" step="0.01" name="medical" id="medical"
                            value="{{ latest_payroll.medical_allowance|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="other_allowances" class="form-label">Other Allowances (₹)</label>
                        <input type="number" step="0.01" name="other_allowances" id="other_allowances"
                            value="{{ latest_payroll.other_allowances|default:'0' }}" class="form-input">
                    </div>
                </div>

                <h4 class="mb-3 mt-4">Deductions</h4>
                <div class="grid grid-2" style="gap: var(--spacing-md);">
                    <div class="form-group">
                        <label for="pf" class="form-label">Provident Fund (₹)</label>
                        <input type="number" step="0.01" name="pf" id="pf"
                            value="{{ latest_payroll.provident_fund|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="professional_tax" class="form-label">Professional Tax (₹)</label>
                        <input type="number" step="0.01" name="professional_tax" id="professional_tax"
                            value="{{ latest_payroll.professional_tax|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="income_tax" class="form-label">Income Tax (₹)</label>
                        <input type="number" step="0.01" name="income_tax" id="income_tax"
                            value="{{ latest_payroll.income_tax|default:'0' }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="other_deductions" class="form-label">Other Deductions (₹)</label>
                        <input type="number" step="0.01" name="other_deductions" id="other_deductions"
                            value="{{ latest_payroll.other_deductions|default:'0' }}" class="form-input">
                    </div>
                </div>

                <div class="d-flex gap-3 mt-5">
                    <button type="submit" class="btn btn-success btn-lg">Update Salary</button>
                    <a href="{% url 'admin_salary_management' %}" class="btn btn-outline btn-lg">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    {% if latest_payroll %}
    <div class="card mt-4 animate-fadeIn" style="animation-delay: 0.1s;">
        <div class="card-header">
            <h3 class="card-title">Current Salary Summary</h3>
        </div>
        <div class="card-body">
            <div class="grid grid-3">
                <div class="text-center">
                    <p class="text-gray" style="font-size: 0.875rem;">Gross Salary</p>
                    <p class="fw-bold text-success" style="font-size: 1.5rem;">₹{{
                        latest_payroll.gross_salary|floatformat:0 }}</p>
                </div>
                <div class="text-center">
                    <p class="text-gray" style="font-size: 0.875rem;">Total Deductions</p>
                    <p class="fw-bold text-error" style="font-size: 1.5rem;">₹{{
                        latest_payroll.total_deductions|floatformat:0 }}</p>
                </div>
                <div class="text-center">
                    <p class="text-gray" style="font-size: 0.875rem;">Net Salary</p>
                    <p class="fw-bold text-primary" style="font-size: 1.5rem;">₹{{
                        latest_payroll.net_salary|floatformat:0 }}</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}